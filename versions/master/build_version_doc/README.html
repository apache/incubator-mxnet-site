<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>MXNet Documentation Build Scripts — mxnet  documentation</title>
<link crossorigin="anonymous" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" rel="stylesheet"/>
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet"/>
<link href="../_static/basic.css" rel="stylesheet" type="text/css">
<link href="../_static/pygments.css" rel="stylesheet" type="text/css">
<link href="../_static/mxnet.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
<script src="https://code.jquery.com/jquery-1.11.1.min.js" type="text/javascript"></script>
<script src="../_static/underscore.js" type="text/javascript"></script>
<script src="../_static/searchtools_custom.js" type="text/javascript"></script>
<script src="../_static/doctools.js" type="text/javascript"></script>
<script src="../_static/selectlang.js" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
<script type="text/javascript"> jQuery(function() { Search.loadIndex("/searchindex.js"); Search.init();}); </script>
<script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new
      Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-96378503-1', 'auto');
      ga('send', 'pageview');

    </script>
<!-- -->
<!-- <script type="text/javascript" src="../_static/jquery.js"></script> -->
<!-- -->
<!-- <script type="text/javascript" src="../_static/underscore.js"></script> -->
<!-- -->
<!-- <script type="text/javascript" src="../_static/doctools.js"></script> -->
<!-- -->
<!-- <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> -->
<!-- -->
<link href="../genindex.html" rel="index" title="Index">
<link href="../search.html" rel="search" title="Search"/>
<link href="https://raw.githubusercontent.com/dmlc/web-data/master/mxnet/image/mxnet-icon.png" rel="icon" type="image/png"/>
</link></link></link></head>
<body background="https://raw.githubusercontent.com/dmlc/web-data/master/mxnet/image/mxnet-background-compressed.jpeg" role="document">
<div class="content-block"><div class="navbar navbar-fixed-top">
<div class="container" id="navContainer">
<div class="innder" id="header-inner">
<h1 id="logo-wrap">
<a href="../" id="logo"><img src="https://raw.githubusercontent.com/dmlc/web-data/master/mxnet/image/mxnet_logo.png"/></a>
</h1>
<nav class="nav-bar" id="main-nav">
<a class="main-nav-link" href="../install/index.html">Install</a>
<span id="dropdown-menu-position-anchor">
<a aria-expanded="true" aria-haspopup="true" class="main-nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button">Gluon <span class="caret"></span></a>
<ul class="dropdown-menu navbar-menu" id="package-dropdown-menu">
<li><a class="main-nav-link" href="../gluon/index.html">About</a></li>
<li><a class="main-nav-link" href="http://gluon.mxnet.io">Tutorials</a></li>
</ul>
</span>
<span id="dropdown-menu-position-anchor">
<a aria-expanded="true" aria-haspopup="true" class="main-nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button">API <span class="caret"></span></a>
<ul class="dropdown-menu navbar-menu" id="package-dropdown-menu">
<li><a class="main-nav-link" href="../api/python/index.html">Python</a></li>
<li><a class="main-nav-link" href="../api/c++/index.html">C++</a></li>
<li><a class="main-nav-link" href="../api/scala/index.html">Scala</a></li>
<li><a class="main-nav-link" href="../api/julia/index.html">Julia</a></li>
<li><a class="main-nav-link" href="../api/perl/index.html">Perl</a></li>
<li><a class="main-nav-link" href="../api/r/index.html">R</a></li>
</ul>
</span>
<span id="dropdown-menu-position-anchor-docs">
<a aria-expanded="true" aria-haspopup="true" class="main-nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button">Docs <span class="caret"></span></a>
<ul class="dropdown-menu navbar-menu" id="package-dropdown-menu-docs">
<li><a class="main-nav-link" href="../faq/index.html">FAQ</a></li>
<li><a class="main-nav-link" href="../tutorials/index.html">Tutorials</a>
<li><a class="main-nav-link" href="https://github.com/apache/incubator-mxnet/tree/master/example">Examples</a></li>
<li><a class="main-nav-link" href="../architecture/index.html">Architecture</a></li>
<li><a class="main-nav-link" href="../api/python/gluon/model_zoo.html">Model Zoo</a></li>
<li><a class="main-nav-link" href="../api/python/contrib/onnx.html">ONNX</a></li>
</li></ul>
</span>
<span id="dropdown-menu-position-anchor-community">
<a aria-expanded="true" aria-haspopup="true" class="main-nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button">Community <span class="caret"></span></a>
<ul class="dropdown-menu navbar-menu" id="package-dropdown-menu-community">
<li><a class="main-nav-link" href="http://discuss.mxnet.io">Forum</a></li>
<li><a class="main-nav-link" href="https://github.com/apache/incubator-mxnet">Github</a></li>
<li><a class="main-nav-link" href="../community/index.html">Community</a></li>
<li><a class="main-nav-link" href="../community/contribute.html">Contribute</a></li>
<li><a class="main-nav-link" href="../community/powered_by.html">Powered By</a></li>
</ul>
</span>
<span id="dropdown-menu-position-anchor-version" style="position: relative"><a href="#" class="main-nav-link dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="true">Versions(master)<span class="caret"></span></a><ul id="package-dropdown-menu" class="dropdown-menu"><li><a class="main-nav-link" href=http://107.21.90.138/>master</a></li><li><a class="main-nav-link" href=http://107.21.90.138/versions/1.2.0/index.html>1.2.0</a></li><li><a class="main-nav-link" href=http://107.21.90.138/versions/1.1.0/index.html>1.1.0</a></li><li><a class="main-nav-link" href=http://107.21.90.138/versions/1.0.0/index.html>1.0.0</a></li><li><a class="main-nav-link" href=http://107.21.90.138/versions/0.12.0/index.html>0.12.0</a></li><li><a class="main-nav-link" href=http://107.21.90.138/versions/0.11.0/index.html>0.11.0</a></li></ul></span></nav>
<script> function getRootPath(){ return "../" } </script>
<div class="burgerIcon dropdown">
<a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button">☰</a>
<ul class="dropdown-menu" id="burgerMenu">
<li><a href="../install/index.html">Install</a></li>
<li><a class="main-nav-link" href="../tutorials/index.html">Tutorials</a></li>
<li class="dropdown-submenu">
<a href="#" tabindex="-1">Community</a>
<ul class="dropdown-menu">
<li><a href="../community/index.html" tabindex="-1">Community</a></li>
<li><a href="../community/contribute.html" tabindex="-1">Contribute</a></li>
<li><a href="../community/powered_by.html" tabindex="-1">Powered By</a></li>
</ul>
</li>
<li class="dropdown-submenu">
<a href="#" tabindex="-1">API</a>
<ul class="dropdown-menu">
<li><a href="../api/python/index.html" tabindex="-1">Python</a>
</li>
<li><a href="../api/scala/index.html" tabindex="-1">Scala</a>
</li>
<li><a href="../api/r/index.html" tabindex="-1">R</a>
</li>
<li><a href="../api/julia/index.html" tabindex="-1">Julia</a>
</li>
<li><a href="../api/c++/index.html" tabindex="-1">C++</a>
</li>
<li><a href="../api/perl/index.html" tabindex="-1">Perl</a>
</li>
</ul>
</li>
<li class="dropdown-submenu">
<a href="#" tabindex="-1">Docs</a>
<ul class="dropdown-menu">
<li><a href="../tutorials/index.html" tabindex="-1">Tutorials</a></li>
<li><a href="../faq/index.html" tabindex="-1">FAQ</a></li>
<li><a href="../architecture/index.html" tabindex="-1">Architecture</a></li>
<li><a href="https://github.com/apache/incubator-mxnet/tree/master/example" tabindex="-1">Examples</a></li>
<li><a href="../api/python/gluon/model_zoo.html" tabindex="-1">Gluon Model Zoo</a></li>
</ul>
</li>
<li><a href="../architecture/index.html">Architecture</a></li>
<li><a class="main-nav-link" href="https://github.com/dmlc/mxnet">Github</a></li>
<li id="dropdown-menu-position-anchor-version-mobile" class="dropdown-submenu" style="position: relative"><a href="#" tabindex="-1">Versions(master)</a><ul class="dropdown-menu"><li><a tabindex="-1" href=http://107.21.90.138/>master</a></li><li><a tabindex="-1" href=http://107.21.90.138/versions/1.2.0/index.html>1.2.0</a></li><li><a tabindex="-1" href=http://107.21.90.138/versions/1.1.0/index.html>1.1.0</a></li><li><a tabindex="-1" href=http://107.21.90.138/versions/1.0.0/index.html>1.0.0</a></li><li><a tabindex="-1" href=http://107.21.90.138/versions/0.12.0/index.html>0.12.0</a></li><li><a tabindex="-1" href=http://107.21.90.138/versions/0.11.0/index.html>0.11.0</a></li></ul></li></ul>
</div>
<div class="plusIcon dropdown">
<a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button"><span aria-hidden="true" class="glyphicon glyphicon-plus"></span></a>
<ul class="dropdown-menu dropdown-menu-right" id="plusMenu"></ul>
</div>
<div id="search-input-wrap">
<form action="../search.html" autocomplete="off" class="" method="get" role="search">
<div class="form-group inner-addon left-addon">
<i class="glyphicon glyphicon-search"></i>
<input class="form-control" name="q" placeholder="Search" type="text"/>
</div>
<input name="check_keywords" type="hidden" value="yes">
<input name="area" type="hidden" value="default"/>
</input></form>
<div id="search-preview"></div>
</div>
<div id="searchIcon">
<span aria-hidden="true" class="glyphicon glyphicon-search"></span>
</div>
<!-- <div id="lang-select-wrap"> -->
<!--   <label id="lang-select-label"> -->
<!--     <\!-- <i class="fa fa-globe"></i> -\-> -->
<!--     <span></span> -->
<!--   </label> -->
<!--   <select id="lang-select"> -->
<!--     <option value="en">Eng</option> -->
<!--     <option value="zh">中文</option> -->
<!--   </select> -->
<!-- </div> -->
<!--     <a id="mobile-nav-toggle">
        <span class="mobile-nav-toggle-bar"></span>
        <span class="mobile-nav-toggle-bar"></span>
        <span class="mobile-nav-toggle-bar"></span>
      </a> -->
</div>
</div>
</div>
<script type="text/javascript">
        $('body').css('background', 'white');
    </script>
<div class="container">
<div class="row">
<div aria-label="main navigation" class="sphinxsidebar leftsidebar" role="navigation">
<div class="sphinxsidebarwrapper">
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/python/index.html">Python Documents</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/r/index.html">R Documents</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/julia/index.html">Julia Documents</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/c++/index.html">C++ Documents</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/scala/index.html">Scala Documents</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/perl/index.html">Perl Documents</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/index.html">HowTo Documents</a></li>
<li class="toctree-l1"><a class="reference internal" href="../architecture/index.html">System Documents</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../community/index.html">Community</a></li>
</ul>
</div>
</div>
<div class="content">
<div class="page-tracker"></div>
<div class="section" id="mxnet-documentation-build-scripts">
<span id="mxnet-documentation-build-scripts"></span><h1>MXNet Documentation Build Scripts<a class="headerlink" href="#mxnet-documentation-build-scripts" title="Permalink to this headline">¶</a></h1>
<p>This folder contains a variety of scripts to generate the MXNet.io website as well as the docs for different versions of MXNet.</p>
<div class="section" id="contents">
<span id="contents"></span><h2>Contents<a class="headerlink" href="#contents" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="https://mxnet.incubator.apache.org/build_version_doc/AddPackageLink.py">AddPackageLink.py</a> - MXNet.io site data massaging; injects pip version numbers in the different versions’ install pages</li>
<li><a class="reference external" href="https://mxnet.incubator.apache.org/build_version_doc/AddVersion.py">AddVersion.py</a> - MXNet.io site data massaging; injects the versions dropdown menu in the navigation bar</li>
<li><a class="reference external" href="https://mxnet.incubator.apache.org/build_version_doc/build_site_tag.sh">build_site_tag.sh</a> - takes version tags as input and generates static html; calls <code class="docutils literal"><span class="pre">build_all_version.sh</span></code> and <code class="docutils literal"><span class="pre">update_all_version.sh</span></code></li>
<li><a class="reference external" href="https://mxnet.incubator.apache.org/build_version_doc/build_all_version.sh">build_all_version.sh</a> - takes version tags as input and builds the basic static html for MXNet.io</li>
<li><a class="reference external" href="https://mxnet.incubator.apache.org/build_version_doc/build_doc.sh">build_doc.sh</a> - used by the CI system to generate MXNet.io; only triggered by new tags; not meant for manual runs or custom outputs</li>
<li><a class="reference external" href="https://mxnet.incubator.apache.org/build_version_doc/Dockerfile">Dockerfile</a> - has all dependencies needed to build and update MXNet.io’s static html</li>
<li><a class="reference external" href="https://mxnet.incubator.apache.org/build_version_doc/update_all_version.sh">update_all_version.sh</a> - takes the output of <code class="docutils literal"><span class="pre">build_all_version.sh</span></code> then uses <code class="docutils literal"><span class="pre">AddVersion.py</span></code> and <code class="docutils literal"><span class="pre">AddPackageLink.py</span></code> to update the static html</li>
</ul>
</div>
<div class="section" id="ci-flow">
<span id="ci-flow"></span><h2>CI Flow<a class="headerlink" href="#ci-flow" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li>Calls <code class="docutils literal"><span class="pre">build_doc.sh</span></code>.</li>
<li><code class="docutils literal"><span class="pre">VersionedWeb</span></code> folder generated with static html of site; old versions are in <code class="docutils literal"><span class="pre">VersionedWeb/versions</span></code>.</li>
<li><code class="docutils literal"><span class="pre">asf-site</span></code> branch from the <a class="reference external" href="https://github.com/apache/incubator-mxnet-site">incubator-mxnet-site</a> project is checked out and contents are deleted.</li>
<li>New site content from <code class="docutils literal"><span class="pre">VersionedWeb</span></code> is copied into <code class="docutils literal"><span class="pre">asf-site</span></code> branch and then committed with <code class="docutils literal"><span class="pre">git</span></code>.</li>
<li><a class="reference external" href="https://mxnet.incubator.apache.org">MXNet.io</a> should then show the new content.</li>
</ol>
</div>
<div class="section" id="manual-generation">
<span id="manual-generation"></span><h2>Manual Generation<a class="headerlink" href="#manual-generation" title="Permalink to this headline">¶</a></h2>
<p>Use Ubuntu and the setup defined below, or use the Dockerfile provided in this folder to spin up an Ubuntu image with all of the dependencies. Further info on Docker is provided later in this document. For a cloud image, this was tested on <a class="reference external" href="https://aws.amazon.com/marketplace/pp/B077GCH38C?qid=1520359179176">Deep Learning AMI v5</a>.</p>
<p><strong>Note</strong>: for AMI users or if you already have Conda, you might be stuck with the latest version and the docs build will have a conflict. To fix this, run <code class="docutils literal"><span class="pre">/home/ubuntu/anaconda3/bin/pip</span> <span class="pre">uninstall</span> <span class="pre">sphinx</span></code> and follow this with <code class="docutils literal"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">--user</span> <span class="pre">sphinx==1.5.6</span></code>.</p>
<p>If you need to build <= v0.12.0, then use a Python 2 environment to avoid errors with <code class="docutils literal"><span class="pre">mxdoc.py</span></code>. This is a sphinx extension, that was not Python 3 compatible in the old versions. On the Deep Learning AMI, use <code class="docutils literal"><span class="pre">source</span> <span class="pre">activate</span> <span class="pre">mxnet_p27</span></code>, and then install the following dependencies.</p>
<div class="section" id="dependencies">
<span id="dependencies"></span><h3>Dependencies<a class="headerlink" href="#dependencies" title="Permalink to this headline">¶</a></h3>
<p>These are the dependencies for docs generation for Ubuntu 16.04.</p>
<p>This script is available for you to run directly on Ubuntu from the source repository.
Run <code class="docutils literal"><span class="pre">./setup_docs_ubuntu.sh</span></code>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">update</span>
<span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="o">-</span><span class="n">y</span> \
    <span class="n">apt</span><span class="o">-</span><span class="n">transport</span><span class="o">-</span><span class="n">https</span> \
    <span class="n">ca</span><span class="o">-</span><span class="n">certificates</span> \
    <span class="n">curl</span> \
    <span class="n">doxygen</span> \
    <span class="n">git</span> \
    <span class="n">libjemalloc</span><span class="o">-</span><span class="n">dev</span> \
    <span class="n">pandoc</span> \
    <span class="n">software</span><span class="o">-</span><span class="n">properties</span><span class="o">-</span><span class="n">common</span>

<span class="c1"># You made need to run `/home/ubuntu/anaconda3/bin/pip uninstall sphinx`</span>
<span class="c1"># Recommonmark/Sphinx errors: https://github.com/sphinx-doc/sphinx/issues/3800</span>
<span class="c1"># Recommonmark should be replaced so Sphinx can be upgraded</span>
<span class="c1"># For now we remove other versions of Sphinx and pin it to v1.5.6</span>

<span class="n">pip</span> <span class="n">install</span> <span class="o">--</span><span class="n">user</span> \
    <span class="n">beautifulsoup4</span> \
    <span class="n">breathe</span> \
    <span class="n">CommonMark</span><span class="o">==</span><span class="mf">0.5</span><span class="o">.</span><span class="mi">4</span> \
    <span class="n">h5py</span> \
    <span class="n">mock</span><span class="o">==</span><span class="mf">1.0</span><span class="o">.</span><span class="mi">1</span> \
    <span class="n">pypandoc</span> \
    <span class="n">recommonmark</span><span class="o">==</span><span class="mf">0.4</span><span class="o">.</span><span class="mi">0</span> \
    <span class="n">sphinx</span><span class="o">==</span><span class="mf">1.5</span><span class="o">.</span><span class="mi">6</span>

<span class="c1"># Setup scala</span>
<span class="n">echo</span> <span class="s2">"deb https://dl.bintray.com/sbt/debian /"</span> <span class="o">|</span> <span class="n">sudo</span> <span class="n">tee</span> <span class="o">-</span><span class="n">a</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">apt</span><span class="o">/</span><span class="n">sources</span><span class="o">.</span><span class="n">list</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">sbt</span><span class="o">.</span><span class="n">list</span>
<span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">key</span> <span class="n">adv</span> <span class="o">--</span><span class="n">keyserver</span> <span class="n">hkp</span><span class="p">:</span><span class="o">//</span><span class="n">keyserver</span><span class="o">.</span><span class="n">ubuntu</span><span class="o">.</span><span class="n">com</span><span class="p">:</span><span class="mi">80</span> <span class="o">--</span><span class="n">recv</span> <span class="mi">2</span><span class="n">EE0EA64E40A89B84B2DF73499E82A75642AC823</span>
<span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">update</span>
<span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="o">-</span><span class="n">y</span> \
  <span class="n">sbt</span> \
  <span class="n">scala</span>

<span class="c1"># Optionally setup Apache2</span>
<span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="o">-</span><span class="n">y</span> <span class="n">apache2</span>
<span class="n">sudo</span> <span class="n">ufw</span> <span class="n">allow</span> <span class="s1">'Apache Full'</span>
<span class="c1"># turn on mod_rewrite</span>
<span class="n">sudo</span> <span class="n">a2enmod</span> <span class="n">rewrite</span>

<span class="n">echo</span> <span class="s1">'To enable redirects you need to edit /etc/apache2/apache2.conf '</span>
<span class="n">echo</span> <span class="s1">'--> Change directives for Directory for /var/www/html using the following: '</span>
<span class="n">echo</span> <span class="s1">'       AllowOverride all '</span>
<span class="n">echo</span> <span class="s1">'--> Then restart apache with: '</span>
<span class="n">echo</span> <span class="s1">'       sudo systemctl restart apache2'</span>

<span class="c1"># Cleanup</span>
<span class="n">sudo</span> <span class="n">apt</span> <span class="n">autoremove</span> <span class="o">-</span><span class="n">y</span>
</pre></div>
</div>
</div>
<div class="section" id="full-website-build">
<span id="full-website-build"></span><h3>Full Website Build<a class="headerlink" href="#full-website-build" title="Permalink to this headline">¶</a></h3>
<p>The following three scripts will help you build multiple version tags and deploy a full site build that with each available API version. If you just want to run master or your current fork’s branch you should skip ahead to the <a class="reference external" href="#developer-instructions">Developer Instructions</a>.</p>
<p>The full site build scripts can be run stand-alone or in conjunction, but <code class="docutils literal"><span class="pre">build_all_version.sh</span></code> should be run first.</p>
</div>
<div class="section" id="build-all-version-sh">
<span id="build-all-version-sh"></span><h3>build_all_version.sh<a class="headerlink" href="#build-all-version-sh" title="Permalink to this headline">¶</a></h3>
<p>This will checkout each tag provided as an argument and build the docs in the <code class="docutils literal"><span class="pre">apache_mxnet</span></code> folder. The output is copied to the <code class="docutils literal"><span class="pre">VersionedWeb</span></code> folder and each version will have a subfolder in <code class="docutils literal"><span class="pre">VersionedWeb/versions/</span></code>.</p>
<p>Takes one argument:</p>
<ul class="simple">
<li><strong>tag list</strong> - space delimited list of Github tags; Example: “1.1.0 1.0.0 master”</li>
</ul>
<p><strong>Example Usage</strong>:
<code class="docutils literal"><span class="pre">./build_all_version.sh</span> <span class="pre">"1.1.0</span> <span class="pre">1.0.0</span> <span class="pre">0.12.1</span> <span class="pre">0.12.0</span> <span class="pre">0.11.0</span> <span class="pre">master"</span></code></p>
</div>
<div class="section" id="update-all-version-sh">
<span id="update-all-version-sh"></span><h3>update_all_version.sh<a class="headerlink" href="#update-all-version-sh" title="Permalink to this headline">¶</a></h3>
<p>This uses the output of <code class="docutils literal"><span class="pre">build_all_version.sh</span></code>. If you haven’t built the specific tag yet, then you cannot update it.
You can, however, elect to update one or more tags to target the updates you’re making.
Takes three arguments:</p>
<ul class="simple">
<li><strong>tag list</strong> - space delimited list of Github tags; Example: “1.1.0 1.0.0 master”</li>
<li><strong>default tag</strong> - which version should the site default to; Example: 1.0.0</li>
<li><strong>root URL</strong> - for the versions dropdown to change to production or dev server; Example: http://mxnet.incubator.apache.org/</li>
</ul>
<p>Each subfolder in <code class="docutils literal"><span class="pre">VersionedWeb/versions</span></code> will be processed with <code class="docutils literal"><span class="pre">AddVersion.py</span></code> and <code class="docutils literal"><span class="pre">AddPackageLink.py</span></code> to update the static html. Finally, the tag specified as the default tag, will be copied to the root of <code class="docutils literal"><span class="pre">VersionedWeb</span></code> to serve as MXNet.io’s home (default) website. The other versions are accessible via the versions dropdown menu in the top level navigation of the website.</p>
<p><strong>Example Usage</strong>:
<code class="docutils literal"><span class="pre">./update_all_version.sh</span> <span class="pre">"1.1.0</span> <span class="pre">1.0.0</span> <span class="pre">0.12.1</span> <span class="pre">0.12.0</span> <span class="pre">0.11.0</span> <span class="pre">master"</span> <span class="pre">1.1.0</span> <span class="pre">http://mxnet.incubator.apache.org/</span></code></p>
</div>
<div class="section" id="build-site-tag-sh">
<span id="build-site-tag-sh"></span><h3>build_site_tag.sh<a class="headerlink" href="#build-site-tag-sh" title="Permalink to this headline">¶</a></h3>
<p>This one is useful for Docker, or to easily chain the two prior scripts. When you run the image you can call this script as a command a pass the tags, default tag, and root url.</p>
<p>Takes the same three arguments that update_all_version.sh takes.
It will execute <code class="docutils literal"><span class="pre">build_all_version.sh</span></code> first, then execute <code class="docutils literal"><span class="pre">update_all_version.sh</span></code> next.</p>
<p><strong>Example Usage</strong>:
./build_site_tag.sh “1.1.0 master” 1.1.0 http://mxnet.incubator.apache.org/
Then run a web server on the outputted <code class="docutils literal"><span class="pre">VersionedWeb</span></code> folder.</p>
</div>
</div>
<div class="section" id="developer-instructions">
<span id="developer-instructions"></span><h2>Developer Instructions<a class="headerlink" href="#developer-instructions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="build-docs-for-your-current-branch">
<span id="build-docs-for-your-current-branch"></span><h3>Build Docs for Your Current Branch<a class="headerlink" href="#build-docs-for-your-current-branch" title="Permalink to this headline">¶</a></h3>
<p>From the MXNet source root run:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>make docs <span class="nv">USE_OPENMP</span><span class="o">=</span><span class="m">1</span>
</pre></div>
</div>
<p>The files from <code class="docutils literal"><span class="pre">make</span> <span class="pre">docs</span></code> are viewable in <code class="docutils literal"><span class="pre">docs/_build/html/</span></code>.</p>
<p><strong>NOTE:</strong> <code class="docutils literal"><span class="pre">make</span> <span class="pre">docs</span></code> doesn’t add any version information, and the versions dropdown in the top level navigation is not present. UI bugs can be introduced when the versions dropdown is included, so just testing with <code class="docutils literal"><span class="pre">make</span> <span class="pre">docs</span></code> may be insufficient.</p>
<p><strong>IMPORTANT:</strong> There are several post-build modifications to the website. This may be responsible for magical or unexplained site behavior. Refer to <a class="reference external" href="#full-website-build">Full Site Build Instructions</a> and the <a class="reference external" href="#developer-notes">Developer Notes</a> for more information.</p>
</div>
<div class="section" id="developer-notes">
<span id="developer-notes"></span><h3>Developer Notes<a class="headerlink" href="#developer-notes" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><code class="docutils literal"><span class="pre">AddVersion.py</span></code> depends on Beautiful library, which requires target html files to have close tags. Although open tag html can still be rendered by browser, it will be problematic for Beautifulsoup. <strong>This is why the install/index.md page has many rendering issues and is very brittle.</strong></li>
<li><code class="docutils literal"><span class="pre">AddVersion.py</span></code> and <code class="docutils literal"><span class="pre">AddPackageLink.py</span></code> manipulates content for website. If there are layout changes, it may break these two scripts. You will need to change scripts respectively. The <a class="reference external" href="#full-website-build">Full Site Build Instructions</a> and related scripts leverage these files. If you want to add further post-build site manipulations, this is your starting point, but make sure you include these processes in the related site build scripts.</li>
<li>A table of contents feature is used on many pages. The docs build looks for toc-tree tags, so any additions to content may require updates to these tags.</li>
<li>The install index page is used for installation validation by triggering from the comment tags, so do not alter these without reviewing the related CI processes.</li>
</ol>
</div>
<div class="section" id="serving-your-development-version">
<span id="serving-your-development-version"></span><h3>Serving Your Development Version<a class="headerlink" href="#serving-your-development-version" title="Permalink to this headline">¶</a></h3>
<p>You can view the generated docs with whatever web server you prefer. The Ubuntu setup script described earlier provides instructions for Apache2. MacOS comes preinstalled with Apache.</p>
<div class="section" id="serve-the-website-with-apache2">
<span id="serve-the-website-with-apache2"></span><h4>Serve the Website with Apache2<a class="headerlink" href="#serve-the-website-with-apache2" title="Permalink to this headline">¶</a></h4>
<div class="highlight-bash"><div class="highlight"><pre><span></span>sudo apt-get install -y apache2
sudo ufw allow <span class="s1">'Apache Full'</span>
</pre></div>
</div>
<p>Copy your <code class="docutils literal"><span class="pre">docs/_build/html/</span></code> files to where your Apache server will pick them up. If you used the default Ubuntu setup, then this will be <code class="docutils literal"><span class="pre">/var/www/html</span></code>.</p>
<p>For example, for a simple local development build, from the MXNet root folder:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="nb">cd</span> docs/_build/html
sudo cp -r . /var/www/html/
</pre></div>
</div>
<p>Or if you’re using the output from the <a class="reference external" href="#full-website-build">Full Website Build</a>, from the <code class="docutils literal"><span class="pre">build_doc_version</span></code> folder:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="nb">cd</span> VersionedWeb
sudo cp -r . /var/www/html/
</pre></div>
</div>
<p><strong>Note</strong>: When generating docs, many files and folders can be deleted or renamed, so it is a good practice to purge the web server directory first, or else you will have old files hanging around potentially introducing errors or hiding broken links.</p>
</div>
<div class="section" id="serve-the-website-with-python3">
<span id="serve-the-website-with-python3"></span><h4>Serve the Website with Python3<a class="headerlink" href="#serve-the-website-with-python3" title="Permalink to this headline">¶</a></h4>
<p>Python has a simple web server that you can use for a quick check on your site build. If your SSH tunnel breaks, the site will stop working, so if you plan to share your work as preview in a PR, use Apache2 instead.</p>
<p>From the MXNet source root run:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="nb">cd</span> docs/_build/html
python3 -m http.server
</pre></div>
</div>
</div>
</div>
<div class="section" id="enabling-redirects">
<span id="enabling-redirects"></span><h3>Enabling Redirects<a class="headerlink" href="#enabling-redirects" title="Permalink to this headline">¶</a></h3>
<p>The website uses redirects with <code class="docutils literal"><span class="pre">mod_rewrite</span></code> for content and folders that have moved. To simulate this locally you need to configure Apache to allow the rewrite module.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>sudo a2enmod rewrite
</pre></div>
</div>
<p>To enable redirects for the folder with the website you need to edit <code class="docutils literal"><span class="pre">/etc/apache2/apache2.conf</span></code>.
Change directives for <code class="docutils literal"><span class="pre">Directory</span></code> for <code class="docutils literal"><span class="pre">/var/www/html</span></code>, or wherever the build files reside, using the following:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">AllowOverride</span> <span class="nb">all</span>
</pre></div>
</div>
<p>Then restart Apache on Ubuntu with:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>sudo systemctl restart apache2
</pre></div>
</div>
</div>
</div>
<div class="section" id="docker-usage">
<span id="docker-usage"></span><h2>Docker Usage<a class="headerlink" href="#docker-usage" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal"><span class="pre">Dockerfile</span></code> will build all of the docs when you create the docker image. You can also run the scripts listed above to regenerate any tag or collection of tags.</p>
<p>Build like:
sudo docker build -t mxnet:docs-base .</p>
<p>Run like:
sudo docker run -it mxnet:docs-base</p>
</div>
<div class="section" id="deploying-the-website-to-production">
<span id="deploying-the-website-to-production"></span><h2>Deploying the Website to Production<a class="headerlink" href="#deploying-the-website-to-production" title="Permalink to this headline">¶</a></h2>
<p>The production website is hosted from the <code class="docutils literal"><span class="pre">asf-site</span></code> branch of <a class="reference external" href="https://github.com/apache/incubator-mxnet-site">https://github.com/apache/incubator-mxnet-site</a>.</p>
<p>To deploy your website build, you must checkout this repo, delete all of the content, copy your build in, and submit a PR for the update.</p>
<p>There are several manual and semi-automatic processes to be aware of, but the bottom line is that your build should have all of the necessary artifacts for the proper functioning of the site:</p>
<ol class="simple">
<li>The root should have the current <code class="docutils literal"><span class="pre">.htaccess</span></code> file from master in <code class="docutils literal"><span class="pre">/docs/</span></code>. Make sure you’ve updated this in master and included the most recent version in your PR.</li>
<li>The css file from master <code class="docutils literal"><span class="pre">/docs/_static/</span></code> will be needed. Be sure that the different versions of the site work. They might need the old version, but the newer version might fix bugs that were in the tags from the legacy versions.</li>
<li>Pay attention to <code class="docutils literal"><span class="pre">mxdocs.py</span></code> as some docs modifications are happening there.</li>
<li>Review Any other modifications to the legacy versions can be seen in</li>
</ol>
</div>
</div>
</div>
</div>
<div aria-label="main navigation" class="sphinxsidebar rightsidebar" role="navigation">
<div class="sphinxsidebarwrapper">
<h3><a href="../index.html">Table Of Contents</a></h3>
<ul>
<li><a class="reference internal" href="#">MXNet Documentation Build Scripts</a><ul>
<li><a class="reference internal" href="#contents">Contents</a></li>
<li><a class="reference internal" href="#ci-flow">CI Flow</a></li>
<li><a class="reference internal" href="#manual-generation">Manual Generation</a><ul>
<li><a class="reference internal" href="#dependencies">Dependencies</a></li>
<li><a class="reference internal" href="#full-website-build">Full Website Build</a></li>
<li><a class="reference internal" href="#build-all-version-sh">build_all_version.sh</a></li>
<li><a class="reference internal" href="#update-all-version-sh">update_all_version.sh</a></li>
<li><a class="reference internal" href="#build-site-tag-sh">build_site_tag.sh</a></li>
</ul>
</li>
<li><a class="reference internal" href="#developer-instructions">Developer Instructions</a><ul>
<li><a class="reference internal" href="#build-docs-for-your-current-branch">Build Docs for Your Current Branch</a></li>
<li><a class="reference internal" href="#developer-notes">Developer Notes</a></li>
<li><a class="reference internal" href="#serving-your-development-version">Serving Your Development Version</a><ul>
<li><a class="reference internal" href="#serve-the-website-with-apache2">Serve the Website with Apache2</a></li>
<li><a class="reference internal" href="#serve-the-website-with-python3">Serve the Website with Python3</a></li>
</ul>
</li>
<li><a class="reference internal" href="#enabling-redirects">Enabling Redirects</a></li>
</ul>
</li>
<li><a class="reference internal" href="#docker-usage">Docker Usage</a></li>
<li><a class="reference internal" href="#deploying-the-website-to-production">Deploying the Website to Production</a></li>
</ul>
</li>
</ul>
</div>
</div>
</div><div class="footer">
<div class="section-disclaimer">
<div class="container">
<div>
<img height="60" src="https://raw.githubusercontent.com/dmlc/web-data/master/mxnet/image/apache_incubator_logo.png"/>
<p>
            Apache MXNet is an effort undergoing incubation at The Apache Software Foundation (ASF), <strong>sponsored by the <i>Apache Incubator</i></strong>. Incubation is required of all newly accepted projects until a further review indicates that the infrastructure, communications, and decision making process have stabilized in a manner consistent with other successful ASF projects. While incubation status is not necessarily a reflection of the completeness or stability of the code, it does indicate that the project has yet to be fully endorsed by the ASF.
        </p>
<p>
            "Copyright © 2017-2018, The Apache Software Foundation
            Apache MXNet, MXNet, Apache, the Apache feather, and the Apache MXNet project logo are either registered trademarks or trademarks of the Apache Software Foundation."
        </p>
</div>
</div>
</div>
</div> <!-- pagename != index -->
</div>
<script crossorigin="anonymous" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
<script src="../_static/js/sidebar.js" type="text/javascript"></script>
<script src="../_static/js/search.js" type="text/javascript"></script>
<script src="../_static/js/navbar.js" type="text/javascript"></script>
<script src="../_static/js/clipboard.min.js" type="text/javascript"></script>
<script src="../_static/js/copycode.js" type="text/javascript"></script>
<script src="../_static/js/page.js" type="text/javascript"></script>
<script type="text/javascript">
        $('body').ready(function () {
            $('body').css('visibility', 'visible');
        });
    </script>
</body>
</html>